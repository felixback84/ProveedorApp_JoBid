{"version":3,"sources":["../../src/pages/service-win/service-win.module.ts","../../src/pages/service-win/service-win.ts"],"names":[],"mappings":"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","file":"11.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ServiceWinPage } from './service-win';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ServiceWinPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ServiceWinPage),\r\n  ],\r\n})\r\nexport class ServiceWinPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/service-win/service-win.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, AlertController } from 'ionic-angular';\r\n\r\n//-service\r\nimport { SaleService } from '../../services/sale.service';\r\nimport { OfferService } from '../../services/offer.service';\r\nimport { ProfessionalsService } from '../../services/professionals.service';\r\nimport { NotificacionService } from '../../services/notificacion.service';\r\n/**\r\n * Generated class for the ServiceWinPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-service-win',\r\n  templateUrl: 'service-win.html',\r\n})\r\nexport class ServiceWinPage {\r\n  //-data\r\n  DataService: any = [];\r\n  //-view\r\n  user: string;\r\n  offer: string;\r\n  sale: any;\r\n\r\n  userActual: string;\r\n\r\n  //-subcrip\r\n  statusSub: any;\r\n  //timer\r\n  segundos: number = 0;\r\n  minutos: number = 2;\r\n  objNodeTimer: any;\r\n  //button go to home\r\n  disableGoHome: boolean = true;\r\n\r\n  constructor(public navCtrl: NavController, public navParams: NavParams,\r\n    public alertCtrl: AlertController,\r\n    private saleService: SaleService, private offerService: OfferService,\r\n    private professionalsService: ProfessionalsService,\r\n    private notificacionService: NotificacionService,\r\n  ) {\r\n    this.DataService = this.navParams.get('datos');\r\n    this.user = this.DataService['idUser'];\r\n    this.offer = this.DataService['idOff'];\r\n    this.sale = this.DataService['sale'];\r\n    console.log(this.DataService);\r\n    this.userActual = localStorage.getItem('verificacion');\r\n    // console.log(this.userActual);\r\n    this.startTimer();\r\n    this.getStatusService();\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    console.log('ionViewDidLoad ServiceWinPage');\r\n  }\r\n\r\n  getStatusService() {\r\n    this.statusSub = this.saleService.getStatus(this.user, this.offer).subscribe(\r\n      (status) => {\r\n        console.log('statusSub-S service-win');\r\n        console.log(status);\r\n        if (status['$value']) {\r\n          if (status['$value'] == 'Waiting for the professional') {\r\n            this.notificacionHired();\r\n            this.goServiceNew();\r\n          }\r\n          if (status['$value'] == 'Cancelled') {\r\n            this.notificacionCancel();\r\n            this.goIndexService();\r\n          }\r\n          if (status['$value'] == 'CancelledProvider') {\r\n            this.navCtrl.setRoot('ShowPage');\r\n          }\r\n        }\r\n      });\r\n  }\r\n\r\n  goServiceNew() {\r\n    console.info('goServiceWin');\r\n    this.showAlertService();\r\n    //-contarct\r\n    console.log(this.DataService);\r\n    let objContract = { \"status\": 'Waiting for the professional', 'User': this.user, 'info': this.DataService['info'], 'sale': this.DataService['sale'], 'service': this.DataService };\r\n    // console.log(objContract);\r\n    this.professionalsService.newContract(this.userActual, this.offer, objContract);\r\n\r\n    //-data\r\n    let dataService = { 'datos': this.DataService };\r\n    console.log(dataService);\r\n    this.navCtrl.setRoot('ServiceNewPage', dataService);\r\n    // this.navCtrl.setRoot('ServiceNewPage');\r\n    // console.log(this.statusSub);\r\n\r\n  }\r\n\r\n  goIndexService() {\r\n    this.showAlertCancel();\r\n    this.navCtrl.setRoot('ShowPage');\r\n  }\r\n\r\n  goResetProvider() {\r\n    this.saleService.setStatus(this.user, this.offer, 'CancelledProvider');\r\n    this.offerService.setStatus(this.offer, 'CancelledProvider');\r\n  }\r\n\r\n  //-alert\r\n\r\n  showAlertService() {\r\n    let alerteMail = this.alertCtrl.create({\r\n      title: 'Information',\r\n      message: 'Congratulations, the customer has accepted your offer, you can go to the customer to start the service.',\r\n      buttons: ['OK']\r\n    });\r\n    alerteMail.present();\r\n  }\r\n\r\n  showAlertCancel() {\r\n    let alerteMail = this.alertCtrl.create({\r\n      title: 'Information',\r\n      message: 'Sorry. The client has canceled the service.',\r\n      buttons: ['OK']\r\n    });\r\n    alerteMail.present();\r\n  }\r\n\r\n  //--- timer\r\n  startTimer() {\r\n    this.objNodeTimer = setInterval(() => this.timer(), 1000);\r\n  }\r\n\r\n  private timer() {\r\n    if (this.minutos == 0 && this.segundos == 1) {\r\n      this.disableGoHome = false;\r\n    } else {\r\n      if (--this.segundos < 0) {\r\n        this.segundos = 59;\r\n        if (--this.minutos < 0) {\r\n        }\r\n      }\r\n      console.log('contador: ', this.minutos, ':', this.segundos);\r\n    }\r\n  }\r\n\r\n  //-notification\r\n  notificacionHired() {\r\n    console.info('Nota: You have been hired');\r\n    this.notificacionService.mostrar('You have been hired', 5);\r\n  }\r\n  notificacionCancel() {\r\n    console.info('Nota: The service has been canceled');\r\n    this.notificacionService.mostrar('The service has been canceled', 6);\r\n  }\r\n\r\n  //terminamos las subscripciones con firebase\r\n  ionViewWillLeave() {\r\n    console.log('statusSub-US service-win');\r\n    if (this.statusSub != undefined) { this.statusSub.unsubscribe(); }\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/service-win/service-win.ts"],"sourceRoot":""}